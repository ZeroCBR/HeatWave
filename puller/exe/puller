#!/usr/bin/env ruby

require 'puller'

source = Puller::DEFAULT_SOURCE

Puller::Database.initialise
Puller::ModelMarshaler.weather_model = Weather
Puller::ModelMarshaler.location_model = Location

pipeline = { getter: Puller::Getter,
             processor: Puller::Processor,
             marshaler: Puller::ModelMarshaler }

puts "Pulled #{Puller.pull_from(source, pipeline)} records."
